[2021-01-22 20:05:39,945 - WARNING:tensorflow]<_tfmw_add_deprecation_warning>:139: From train.py:75: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

[2021-01-22 20:05:39,945 - INFO:tensorflow]<<module>>:75: 

{
  "batch_size": 128,
  "decay_rate": 0.9,
  "embed_size": 50,
  "filename": "data/citeulike-a.npz",
  "grad_clip": 5.0,
  "hops": 2,
  "item_count": "16980",
  "l2": 0.1,
  "learning_rate": 0.001,
  "logdir": "result/024/",
  "max_neighbors": 311,
  "neg_count": 8,
  "optimizer": "rmsprop",
  "optimizer_params": "{'momentum': 0.9, 'decay': 0.9}",
  "pretrain": "pretrain/citeulike-a_e50.npz",
  "save_directory": "result/024/",
  "tol": 1e-05,
  "user_count": "5551"
}


[2021-01-22 20:05:39,946 - WARNING:tensorflow]<new_func>:323: From /home/jovyan/DataScience/DataScienceMaster/ExperimentalDesign/ExperimentDesign/util/layers.py:250: get_or_create_global_step (from tensorflow.contrib.framework.python.ops.variables) is deprecated and will be removed in a future version.
Instructions for updating:
Please switch to tf.train.get_or_create_global_step
[2021-01-22 20:05:39,955 - WARNING:tensorflow]<_tfmw_add_deprecation_warning>:139: From /home/jovyan/DataScience/DataScienceMaster/ExperimentalDesign/ExperimentDesign/util/layers.py:255: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

[2021-01-22 20:05:39,965 - WARNING:tensorflow]<_tfmw_add_deprecation_warning>:139: From /home/jovyan/DataScience/DataScienceMaster/ExperimentalDesign/ExperimentDesign/util/helper.py:23: The name tf.add_to_collection is deprecated. Please use tf.compat.v1.add_to_collection instead.

[2021-01-22 20:05:40,025 - WARNING:tensorflow]<_tfmw_add_deprecation_warning>:139: From /home/jovyan/DataScience/DataScienceMaster/ExperimentalDesign/ExperimentDesign/util/attention.py:52: The name tf.assert_positive is deprecated. Please use tf.compat.v1.assert_positive instead.

[2021-01-22 20:05:40,067 - INFO:tensorflow]<_build>:187: Creating Hop Mapping 2 with <function relu at 0x7f54521de200>
[2021-01-22 20:05:40,108 - WARNING:tensorflow]<new_func>:506: From /opt/conda/lib/python3.7/site-packages/sonnet/python/modules/basic.py:132: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
[2021-01-22 20:05:40,183 - INFO:tensorflow]<_build>:187: Creating Hop Mapping 2 with <function relu at 0x7f54521de200>
[2021-01-22 20:05:40,225 - WARNING:tensorflow]<_tfmw_add_deprecation_warning>:139: From /home/jovyan/DataScience/DataScienceMaster/ExperimentalDesign/ExperimentDesign/util/layers.py:62: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

[2021-01-22 20:05:40,225 - WARNING:tensorflow]<_tfmw_add_deprecation_warning>:139: From /home/jovyan/DataScience/DataScienceMaster/ExperimentalDesign/ExperimentDesign/util/layers.py:62: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

[2021-01-22 20:05:40,226 - WARNING:tensorflow]<_tfmw_add_deprecation_warning>:139: From /home/jovyan/DataScience/DataScienceMaster/ExperimentalDesign/ExperimentDesign/util/layers.py:37: The name tf.log is deprecated. Please use tf.math.log instead.

[2021-01-22 20:05:40,239 - WARNING:tensorflow]<_tfmw_add_deprecation_warning>:139: From /home/jovyan/DataScience/DataScienceMaster/ExperimentalDesign/ExperimentDesign/util/layers.py:220: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

[2021-01-22 20:05:40,415 - WARNING:tensorflow]<new_func>:323: From /opt/conda/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1424: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
[2021-01-22 20:05:40,804 - WARNING:tensorflow]<new_func>:506: From /opt/conda/lib/python3.7/site-packages/tensorflow_core/python/training/rmsprop.py:119: calling Ones.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
[2021-01-22 20:05:40,908 - WARNING:tensorflow]<_tfmw_add_deprecation_warning>:139: From /home/jovyan/DataScience/DataScienceMaster/ExperimentalDesign/ExperimentDesign/util/cmn.py:44: The name tf.summary.scalar is deprecated. Please use tf.compat.v1.summary.scalar instead.

[2021-01-22 20:05:40,911 - WARNING:tensorflow]<_tfmw_add_deprecation_warning>:139: From /home/jovyan/DataScience/DataScienceMaster/ExperimentalDesign/ExperimentDesign/util/cmn.py:47: The name tf.summary.merge_all is deprecated. Please use tf.compat.v1.summary.merge_all instead.

[2021-01-22 20:05:40,911 - WARNING:tensorflow]<new_func>:323: From train.py:83: Supervisor.__init__ (from tensorflow.python.training.supervisor) is deprecated and will be removed in a future version.
Instructions for updating:
Please switch to tf.train.MonitoredTrainingSession
[2021-01-22 20:05:41,056 - WARNING:tensorflow]<_tfmw_add_deprecation_warning>:139: From train.py:85: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

[2021-01-22 20:05:41,056 - WARNING:tensorflow]<_tfmw_add_deprecation_warning>:139: From train.py:86: The name tf.GPUOptions is deprecated. Please use tf.compat.v1.GPUOptions instead.

[2021-01-22 20:05:41,249 - INFO:tensorflow]<_try_run_local_init_op>:500: Running local_init_op.
[2021-01-22 20:05:41,271 - INFO:tensorflow]<_try_run_local_init_op>:502: Done running local_init_op.
[2021-01-22 20:05:41,907 - INFO:tensorflow]<prepare_or_wait_for_session>:737: Starting standard services.
[2021-01-22 20:05:41,931 - INFO:tensorflow]<run_loop>:1117: Saving checkpoint to path result/024/model.ckpt
[2021-01-22 20:05:41,931 - INFO:tensorflow]<prepare_or_wait_for_session>:743: Starting queue runners.
[2021-01-22 20:05:41,932 - INFO:tensorflow]<<module>>:91: Loading Pretrained Embeddings.... from pretrain/citeulike-a_e50.npz
[2021-01-22 20:15:41,931 - INFO:tensorflow]<run_loop>:1117: Saving checkpoint to path result/024/model.ckpt
[2021-01-22 20:16:01,643 - INFO:tensorflow]<<module>>:120: Epoch 0: Avg Loss/Batch 0.390271            
[2021-01-22 20:16:44,352 - INFO:tensorflow]<evaluate_model>:64: 
HR@1           0.388038      NDCG@1         0.388038
HR@5           0.747073      NDCG@5         0.581305
HR@10          0.857323      NDCG@10        0.617477


[2021-01-22 20:25:41,931 - INFO:tensorflow]<run_loop>:1117: Saving checkpoint to path result/024/model.ckpt
[2021-01-22 20:27:19,174 - INFO:tensorflow]<<module>>:120: Epoch 1: Avg Loss/Batch 0.244301            
[2021-01-22 20:27:56,784 - INFO:tensorflow]<evaluate_model>:64: 
HR@1           0.400108      NDCG@1         0.400108
HR@5           0.760764      NDCG@5         0.593908
HR@10          0.866871      NDCG@10        0.628515


[2021-01-22 20:35:41,931 - INFO:tensorflow]<run_loop>:1117: Saving checkpoint to path result/024/model.ckpt
[2021-01-22 20:38:12,445 - INFO:tensorflow]<<module>>:120: Epoch 2: Avg Loss/Batch 0.186870            
[2021-01-22 20:38:45,173 - INFO:tensorflow]<evaluate_model>:64: 
HR@1           0.377590      NDCG@1         0.377590
HR@5           0.721311      NDCG@5         0.563048
HR@10          0.825077      NDCG@10        0.596775


[2021-01-22 20:45:41,934 - INFO:tensorflow]<run_loop>:1117: Saving checkpoint to path result/024/model.ckpt
[2021-01-22 20:47:37,631 - INFO:tensorflow]<<module>>:120: Epoch 3: Avg Loss/Batch 0.151894            
[2021-01-22 20:48:10,356 - INFO:tensorflow]<evaluate_model>:64: 
HR@1           0.416862      NDCG@1         0.416862
HR@5           0.778238      NDCG@5         0.611517
HR@10          0.874977      NDCG@10        0.643057


[2021-01-22 20:55:41,931 - INFO:tensorflow]<run_loop>:1117: Saving checkpoint to path result/024/model.ckpt
[2021-01-22 20:55:41,962 - WARNING:tensorflow]<new_func>:323: From /opt/conda/lib/python3.7/site-packages/tensorflow_core/python/training/saver.py:963: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
[2021-01-22 20:57:33,041 - INFO:tensorflow]<<module>>:120: Epoch 4: Avg Loss/Batch 0.129380            
[2021-01-22 20:58:06,340 - INFO:tensorflow]<evaluate_model>:64: 
HR@1           0.416321      NDCG@1         0.416321
HR@5           0.779859      NDCG@5         0.613180
HR@10          0.876239      NDCG@10        0.644490


[2021-01-22 21:05:41,932 - INFO:tensorflow]<run_loop>:1117: Saving checkpoint to path result/024/model.ckpt
[2021-01-22 21:07:15,592 - INFO:tensorflow]<<module>>:120: Epoch 5: Avg Loss/Batch 0.113763            
[2021-01-22 21:07:44,310 - INFO:tensorflow]<evaluate_model>:64: 
HR@1           0.404071      NDCG@1         0.404071
HR@5           0.758062      NDCG@5         0.595052
HR@10          0.855341      NDCG@10        0.626624


[2021-01-22 21:15:41,931 - INFO:tensorflow]<run_loop>:1117: Saving checkpoint to path result/024/model.ckpt
[2021-01-22 21:16:57,035 - INFO:tensorflow]<<module>>:120: Epoch 6: Avg Loss/Batch 0.101998            
[2021-01-22 21:17:42,713 - INFO:tensorflow]<evaluate_model>:64: 
HR@1           0.418303      NDCG@1         0.418303
HR@5           0.786165      NDCG@5         0.616095
HR@10          0.879481      NDCG@10        0.646612


[2021-01-22 21:25:41,931 - INFO:tensorflow]<run_loop>:1117: Saving checkpoint to path result/024/model.ckpt
[2021-01-22 21:26:53,592 - INFO:tensorflow]<<module>>:120: Epoch 7: Avg Loss/Batch 0.092403            
[2021-01-22 21:27:22,390 - INFO:tensorflow]<evaluate_model>:64: 
HR@1           0.421546      NDCG@1         0.421546
HR@5           0.788867      NDCG@5         0.620636
HR@10          0.879661      NDCG@10        0.650225


[2021-01-22 21:35:41,931 - INFO:tensorflow]<run_loop>:1117: Saving checkpoint to path result/024/model.ckpt
[2021-01-22 21:36:03,387 - INFO:tensorflow]<<module>>:120: Epoch 8: Avg Loss/Batch 0.085171            
[2021-01-22 21:36:34,496 - INFO:tensorflow]<evaluate_model>:64: 
HR@1           0.433075      NDCG@1         0.433075
HR@5           0.787786      NDCG@5         0.625611
HR@10          0.886867      NDCG@10        0.658080


[2021-01-22 21:45:41,936 - INFO:tensorflow]<run_loop>:1117: Saving checkpoint to path result/024/model.ckpt
[2021-01-22 21:45:57,267 - INFO:tensorflow]<<module>>:120: Epoch 9: Avg Loss/Batch 0.078924            
[2021-01-22 21:46:36,614 - INFO:tensorflow]<evaluate_model>:64: 
HR@1           0.429292      NDCG@1         0.429292
HR@5           0.795893      NDCG@5         0.628210
HR@10          0.886867      NDCG@10        0.657897


[2021-01-22 21:55:41,931 - INFO:tensorflow]<run_loop>:1117: Saving checkpoint to path result/024/model.ckpt
[2021-01-22 21:56:19,473 - INFO:tensorflow]<<module>>:120: Epoch 10: Avg Loss/Batch 0.073733            
[2021-01-22 21:56:54,151 - INFO:tensorflow]<evaluate_model>:64: 
HR@1           0.433796      NDCG@1         0.433796
HR@5           0.794091      NDCG@5         0.628724
HR@10          0.880922      NDCG@10        0.657059


[2021-01-22 22:05:41,931 - INFO:tensorflow]<run_loop>:1117: Saving checkpoint to path result/024/model.ckpt
[2021-01-22 22:05:54,895 - INFO:tensorflow]<<module>>:120: Epoch 11: Avg Loss/Batch 0.069748            
[2021-01-22 22:06:23,983 - INFO:tensorflow]<evaluate_model>:64: 
HR@1           0.436678      NDCG@1         0.436678
HR@5           0.799856      NDCG@5         0.633483
HR@10          0.888308      NDCG@10        0.662441


[2021-01-22 22:15:00,708 - INFO:tensorflow]<<module>>:120: Epoch 12: Avg Loss/Batch 0.065482            
[2021-01-22 22:15:32,066 - INFO:tensorflow]<evaluate_model>:64: 
HR@1           0.434516      NDCG@1         0.434516
HR@5           0.796433      NDCG@5         0.631378
HR@10          0.885246      NDCG@10        0.660377


[2021-01-22 22:15:41,931 - INFO:tensorflow]<run_loop>:1117: Saving checkpoint to path result/024/model.ckpt
[2021-01-22 22:24:49,188 - INFO:tensorflow]<<module>>:120: Epoch 13: Avg Loss/Batch 0.062844            
[2021-01-22 22:25:19,791 - INFO:tensorflow]<evaluate_model>:64: 
HR@1           0.439200      NDCG@1         0.439200
HR@5           0.797694      NDCG@5         0.632879
HR@10          0.884886      NDCG@10        0.661212


[2021-01-22 22:25:41,931 - INFO:tensorflow]<run_loop>:1117: Saving checkpoint to path result/024/model.ckpt
[2021-01-22 22:35:16,863 - INFO:tensorflow]<<module>>:120: Epoch 14: Avg Loss/Batch 0.060453            
[2021-01-22 22:35:41,931 - INFO:tensorflow]<run_loop>:1117: Saving checkpoint to path result/024/model.ckpt
[2021-01-22 22:35:57,652 - INFO:tensorflow]<evaluate_model>:64: 
HR@1           0.442263      NDCG@1         0.442263
HR@5           0.789587      NDCG@5         0.631254
HR@10          0.877680      NDCG@10        0.659989


[2021-01-22 22:45:20,566 - INFO:tensorflow]<<module>>:120: Epoch 15: Avg Loss/Batch 0.057278            
[2021-01-22 22:45:41,932 - INFO:tensorflow]<run_loop>:1117: Saving checkpoint to path result/024/model.ckpt
[2021-01-22 22:45:59,387 - INFO:tensorflow]<evaluate_model>:64: 
HR@1           0.443524      NDCG@1         0.443524
HR@5           0.792650      NDCG@5         0.632197
HR@10          0.880562      NDCG@10        0.661083


[2021-01-22 22:55:41,936 - INFO:tensorflow]<run_loop>:1117: Saving checkpoint to path result/024/model.ckpt
[2021-01-22 22:56:01,470 - INFO:tensorflow]<<module>>:120: Epoch 16: Avg Loss/Batch 0.055020            
[2021-01-22 22:56:33,469 - INFO:tensorflow]<evaluate_model>:64: 
HR@1           0.444424      NDCG@1         0.444424
HR@5           0.801838      NDCG@5         0.637848
HR@10          0.887047      NDCG@10        0.665676


[2021-01-22 23:05:41,931 - INFO:tensorflow]<run_loop>:1117: Saving checkpoint to path result/024/model.ckpt
[2021-01-22 23:06:25,614 - INFO:tensorflow]<<module>>:120: Epoch 17: Avg Loss/Batch 0.053454            
[2021-01-22 23:06:57,732 - INFO:tensorflow]<evaluate_model>:64: 
HR@1           0.439741      NDCG@1         0.439741
HR@5           0.793551      NDCG@5         0.632468
HR@10          0.883084      NDCG@10        0.661475


[2021-01-22 23:15:41,931 - INFO:tensorflow]<run_loop>:1117: Saving checkpoint to path result/024/model.ckpt
[2021-01-22 23:16:18,875 - INFO:tensorflow]<<module>>:120: Epoch 18: Avg Loss/Batch 0.052173            
[2021-01-22 23:16:47,746 - INFO:tensorflow]<evaluate_model>:64: 
HR@1           0.440641      NDCG@1         0.440641
HR@5           0.796433      NDCG@5         0.632818
HR@10          0.882544      NDCG@10        0.660978


[2021-01-22 23:25:28,438 - INFO:tensorflow]<<module>>:120: Epoch 19: Avg Loss/Batch 0.050486            
[2021-01-22 23:25:41,932 - INFO:tensorflow]<run_loop>:1117: Saving checkpoint to path result/024/model.ckpt
[2021-01-22 23:25:59,939 - INFO:tensorflow]<evaluate_model>:64: 
HR@1           0.435057      NDCG@1         0.435057
HR@5           0.794091      NDCG@5         0.630135
HR@10          0.880202      NDCG@10        0.658229


[2021-01-22 23:35:14,432 - INFO:tensorflow]<<module>>:120: Epoch 20: Avg Loss/Batch 0.048855            
[2021-01-22 23:35:41,931 - INFO:tensorflow]<run_loop>:1117: Saving checkpoint to path result/024/model.ckpt
[2021-01-22 23:35:48,819 - INFO:tensorflow]<evaluate_model>:64: 
HR@1           0.439741      NDCG@1         0.439741
HR@5           0.802198      NDCG@5         0.635866
HR@10          0.887047      NDCG@10        0.663467


[2021-01-22 23:45:41,936 - INFO:tensorflow]<run_loop>:1117: Saving checkpoint to path result/024/model.ckpt
[2021-01-22 23:46:02,859 - INFO:tensorflow]<<module>>:120: Epoch 21: Avg Loss/Batch 0.047659            
[2021-01-22 23:46:35,595 - INFO:tensorflow]<evaluate_model>:64: 
HR@1           0.449649      NDCG@1         0.449649
HR@5           0.795893      NDCG@5         0.637038
HR@10          0.883625      NDCG@10        0.665608


[2021-01-22 23:55:41,931 - INFO:tensorflow]<run_loop>:1117: Saving checkpoint to path result/024/model.ckpt
[2021-01-22 23:55:42,841 - INFO:tensorflow]<<module>>:120: Epoch 22: Avg Loss/Batch 0.046799            
[2021-01-22 23:56:13,448 - INFO:tensorflow]<evaluate_model>:64: 
HR@1           0.445145      NDCG@1         0.445145
HR@5           0.798955      NDCG@5         0.636109
HR@10          0.889389      NDCG@10        0.665708


[2021-01-23 00:05:04,095 - INFO:tensorflow]<<module>>:120: Epoch 23: Avg Loss/Batch 0.045788            
[2021-01-23 00:05:33,007 - INFO:tensorflow]<evaluate_model>:64: 
HR@1           0.441722      NDCG@1         0.441722
HR@5           0.804360      NDCG@5         0.638275
HR@10          0.887948      NDCG@10        0.665367


[2021-01-23 00:05:41,931 - INFO:tensorflow]<run_loop>:1117: Saving checkpoint to path result/024/model.ckpt
[2021-01-23 00:13:43,569 - INFO:tensorflow]<<module>>:120: Epoch 24: Avg Loss/Batch 0.044938            
[2021-01-23 00:14:12,535 - INFO:tensorflow]<evaluate_model>:64: 
HR@1           0.448388      NDCG@1         0.448388
HR@5           0.798595      NDCG@5         0.639350
HR@10          0.883444      NDCG@10        0.666983


[2021-01-23 00:15:41,931 - INFO:tensorflow]<run_loop>:1117: Saving checkpoint to path result/024/model.ckpt
[2021-01-23 00:22:21,228 - INFO:tensorflow]<<module>>:120: Epoch 25: Avg Loss/Batch 0.043892            
[2021-01-23 00:22:50,082 - INFO:tensorflow]<evaluate_model>:64: 
HR@1           0.448568      NDCG@1         0.448568
HR@5           0.803819      NDCG@5         0.641772
HR@10          0.887588      NDCG@10        0.669118


[2021-01-23 00:25:41,931 - INFO:tensorflow]<run_loop>:1117: Saving checkpoint to path result/024/model.ckpt
[2021-01-23 00:30:59,329 - INFO:tensorflow]<<module>>:120: Epoch 26: Avg Loss/Batch 0.042780            
[2021-01-23 00:31:28,074 - INFO:tensorflow]<evaluate_model>:64: 
HR@1           0.443163      NDCG@1         0.443163
HR@5           0.800396      NDCG@5         0.636214
HR@10          0.885246      NDCG@10        0.663955


[2021-01-23 00:35:41,931 - INFO:tensorflow]<run_loop>:1117: Saving checkpoint to path result/024/model.ckpt
[2021-01-23 00:39:37,391 - INFO:tensorflow]<<module>>:120: Epoch 27: Avg Loss/Batch 0.042607            
[2021-01-23 00:40:06,118 - INFO:tensorflow]<evaluate_model>:64: 
HR@1           0.451270      NDCG@1         0.451270
HR@5           0.792830      NDCG@5         0.636632
HR@10          0.882904      NDCG@10        0.666074


[2021-01-23 00:45:41,931 - INFO:tensorflow]<run_loop>:1117: Saving checkpoint to path result/024/model.ckpt
[2021-01-23 00:48:12,440 - INFO:tensorflow]<<module>>:120: Epoch 28: Avg Loss/Batch 0.041870            
[2021-01-23 00:48:41,089 - INFO:tensorflow]<evaluate_model>:64: 
HR@1           0.451270      NDCG@1         0.451270
HR@5           0.798595      NDCG@5         0.639583
HR@10          0.882003      NDCG@10        0.666834


[2021-01-23 00:55:41,931 - INFO:tensorflow]<run_loop>:1117: Saving checkpoint to path result/024/model.ckpt
[2021-01-23 00:56:49,880 - INFO:tensorflow]<<module>>:120: Epoch 29: Avg Loss/Batch 0.041179            
[2021-01-23 00:57:18,571 - INFO:tensorflow]<evaluate_model>:64: 
HR@1           0.452531      NDCG@1         0.452531
HR@5           0.803819      NDCG@5         0.643144
HR@10          0.887047      NDCG@10        0.670296


[2021-01-23 00:57:48,706 - INFO:tensorflow]<<module>>:138: HR@1           0.452531      NDCG@1         0.452531
HR@2           0.626193      NDCG@2         0.562100
HR@3           0.714646      NDCG@3         0.606326
HR@4           0.767609      NDCG@4         0.629136
HR@5           0.803819      NDCG@5         0.643144
HR@6           0.829400      NDCG@6         0.652256
HR@7           0.848676      NDCG@7         0.658681
HR@8           0.862367      NDCG@8         0.663001
HR@9           0.875878      NDCG@9         0.667068
HR@10          0.887047      NDCG@10        0.670296

[2021-01-23 00:57:48,706 - INFO:tensorflow]<<module>>:148: Saving model...
[2021-01-23 00:57:48,706 - WARNING:tensorflow]<new_func>:323: From train.py:151: get_global_step (from tensorflow.contrib.framework.python.ops.variables) is deprecated and will be removed in a future version.
Instructions for updating:
Please switch to tf.train.get_global_step
